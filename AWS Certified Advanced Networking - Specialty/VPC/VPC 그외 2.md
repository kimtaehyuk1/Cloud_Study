Cloud Front

![image](https://user-images.githubusercontent.com/67897827/189911273-78abd15f-f504-476a-bbc6-4e33942f3f57.png)

(실습)  
cloud front 배포 생성하기전에 오리진을 s3에 하기 위해 버킷을 미리 생성하기(권한 퍼블릭으로 모두 허용하기) -> Cloud Front 창으로가서 배포생성
-> 원본도메인은 S3 버킷선택, S3버킷 액세스에서 사용안함으로 하고 나머지도 그대로 냅두지만 항목들을 설명해보면
기본 캐시 동작에 뷰어는 cloud front를 사용하는 최종 사용자로 뷰어가 접속할때 어떤 프로토콜 사용할건지에 대한 선택도있고,방법도 지정할수 있다.  
또 뷰어 엑세스 제한이라고 서명된 URL이나 서명된 쿠키를 사용해서 하는 것도 있다.  
또 설정가면 엣지로케이션을 어디서 사용할건지도 있고, WAF도 연결할 수 있고,SSL인증서도 연결가능하고, 기본값 루트 객체로 이 cloud front연결 했을때 여기 적는거를
디폴트로 접속하도록 
-> 후에 나머지 냅두고 배포생성 = 이래되면 이제 엣지 로케이션으로 분배 쫙~ 되는겨
=> 배포 생성되면 도메인이름 복사해서 구글창 치면 cloud front통해 s3버킷 접속 할 수 있다.

![image](https://user-images.githubusercontent.com/67897827/189921387-ac0c87db-6525-4b92-84b9-1808814c6925.png)


![image](https://user-images.githubusercontent.com/67897827/189923906-244439e0-c854-468f-8541-8f98e8851fd1.png)

위의 그림처럼 직접 S3버킷으로 접속하게 되면 지리적으로 원사용자가 컨텐츠를 늦게 받아오게 된다. 따라서 OAI를 사용하게 되면 OAI라는 ID값이있는데
이 아이디 값에서 S3버킷을 허용해 주는것이다. 즉 다이렉트 접속은 OAI가 없으니까 직접 연결을 거부 시킨다.

여러가지 보안방법  
![image](https://user-images.githubusercontent.com/67897827/189925912-3e0a91cf-ae99-48de-868c-a5ca9908f36a.png)

특정 기간이 지나면 접속 못하게 하거나 특정 IP만 접속하도록 하는 것이다. 특히 유료컨텐츠나 컨텐츠 만료기간을 정할때 사용한다.

(실습)  
Cloud Front 에가서 왼쪽 카테고리바에 원본 액세스 ID 생성 -> 이름은 OAI -> 배포로가서 배포클릭하고 원본가서 원본 편집클릭해서 S3버킷 액세스에서 OAI사용으로 바꾸기
ID는 방금 생성한거 넣기 또 버킷정책 에 예,버킷정책 업데이트가 자동으로 된다는것이다 이거 체크하고 변경사항 저장 
-> S3버킷으로가서 권한보면 버킷정책에 뭐가 추가 되있을겨 -> 퍼블릭액세스 차단에서 편집누르기 해서 모든 액세스 차단 누르면 직접 연결이 불가능 해지고
cloud front로 접속하면 접속이 되는것을 확인 할 수 있다.

또 동작에 가서 편집에서 뷰어 프로토콜에 Redirect HTTP to HTTPS로 하면 http로 클라우드 프론트 접속하면 HTTPS로 리다이렉팅 됨.  
또 S3는 HTTP ONLY가 디폴트여서 없을텐데 ALB로 하면 오리진 프로토콜도 설정해서 바꿀 수 있다.  
또 cloud front 동작 편집누르면 뷰어엑세스 제한에서 서명된 URL,쿠키 사용할 수 있고, 또 추가설정 누르면 필드수준 암호화도 설정 할 수 있다.


Lambda@Edge
- 람다는 코드를 통해 수행되는 서버리스 컴퓨팅 서비스 이 람다를 엣지로케이션에서 수행하는 것이다.
- 이 람다를 cloud front에 연결하면 엣지로케이션에서 서버리스 컴퓨팅이 수행이 된다.
- 람다는 이벤트있을때 수행하는 건데 이것또한 cloud front 이벤트 발생할때 수행
![image](https://user-images.githubusercontent.com/67897827/189928534-4ab1338e-ac9b-43a3-9100-830251ea2556.png)



